function Controller(){}function Command(a,b){this.callback=a,this.model=new Model,this.properties=b}function dispatchCommand(a,b){controller.dispatchCommand(a,b)}function removeCommand(a,b){controller.removeCommand(a,b)}function addCommand(a,b,c){controller.addCommand(a,b,c)}Controller.prototype.commands={},Controller.prototype.addCommand=function(a,b,c){if(!this.commands[a]){var d=new Command(b,c);this.commands[a]=d}},Controller.prototype.removeCommand=function(a,b){delete this.commands[a]},Controller.prototype.queue=[],Controller.prototype.dispatchCommand=function(a,b){app.debug&&this.commands[a].callback.name!="tapHandlerCommand"&&console.log(app.context,this.commands[a].callback.name,b),this.commands[a]?this.commands[a].execute(b):console.log("Command "+a+" not registered")},Command.prototype.execute=function(a){this.callback(a||{})};var controller=new Controller;
function zeit(a,b){var c=b?new Date(b):new Date,d=c.getMilliseconds()<10?"0"+c.getMilliseconds():c.getMilliseconds(),e=c.getSeconds()<10?"0"+c.getSeconds():c.getSeconds(),f=c.getMinutes()<10?"0"+c.getMinutes():c.getMinutes(),g=c.getHours()<10?"0"+c.getHours():c.getHours(),h=c.getDate()<10?"0"+c.getDate():c.getDate(),i=c.getMonth()<9?"0"+(c.getMonth()+1):c.getMonth()+1,j=c.getFullYear();a=="yyyy-MM-dd"&&console.log(j+"-"+i+"-"+h);switch(a){case"yyyy-MM-ddThh:mm.ss.ms":return j+"-"+i+"-"+h+"T"+g+":"+f+":"+e+"."+d;case"yyyy-MM-dd":return j+"-"+i+"-"+h;case"dd.mm.yyyy hh:mm":return h+"."+i+"."+j+" "+g+":"+f;case"dd.MM.yyyy hh:mm":return h+"."+i+"."+j+" "+g+":"+f;case"dd.mm.yyyy":return h+"."+i+"."+j;case"hh:mm":return g+":"+f;case"dd":return h;case"ddInMonth":return(new Date(j,i,0)).getDate();case"MM":return i;case"yyyy":return j;case"hh":return g;case"mm":return f;case"dawn":return c.setHours(0,0,0,0),c.getTime();default:return c.getTime()}}(function(a,b,c){var d=function(c){var d=null;typeof c=="string"?d=b.getElementById(c):typeof c=="object"&&(d=c);var e={onTouch:function(b,c){var e=c||{};"ontouchstart"in a?d.addEventListener("touchstart",function(a){e.tag=a.touches[0].target.tagName,dispatchCommand(b,e)},!1):d.addEventListener("mousedown",function(a){e.offsetX=a.offsetX||a.layerX,e.offsetY=a.offsetY||a.layerY,e.tag=a.target.tagName,dispatchCommand(b,e)},!1)},onDone:function(a,b){d.addEventListener("blur",function(c){b.value=c.target.value,b.target=c.target,dispatchCommand(a,b)},!1)},onWindow:function(a,c){var d="",e="";typeof b.hidden!="undefined"?(d="hidden",e="visibilitychange"):typeof b.mozHidden!="undefined"?(d="mozHidden",e="mozvisibilitychange"):typeof b.msHidden!="undefined"?(d="msHidden",e="msvisibilitychange"):typeof b.webkitHidden!="undefined"&&(d="webkitHidden",e="webkitvisibilitychange"),b.addEventListener(e,function(){c.hidden=b[d],dispatchCommand(a,c)})},onMSG:function(a,b){d.addEventListener("message",function(c){c.preventDefault(),b=c.data,b.origin=c.origin,b.source=c.source,dispatchCommand(a,b)},!1)},onClick:function(a,b){d.addEventListener("click",function(c){c.preventDefault(),c.stopPropagation(),c.currentTarget.hasAttribute("href")&&(b.href=c.currentTarget.getAttribute("href")),dispatchCommand(a,b)},!1)},onReturn:function(a,b){d.addEventListener("keydown",function(c){c.keyCode==13&&(c.preventDefault(),c.stopPropagation(),dispatchCommand(a,b))},!1)},onChange:function(b,c){var e=c||{};"addEventListener"in a?(d.addEventListener("change",function(a){e.value=a.target.value,e.id=a.target.id,dispatchCommand(b,e)},!1),d.addEventListener("keyup",function(a){e.value=a.target.value,e.id=a.target.id,dispatchCommand(b,e)},!1)):"attachEvent"in a&&(d.attachEvent("onchange",function(a){e.value=a.srcElement.value,e.id=a.srcElement.id,dispatchCommand(b,e)}),d.attachEvent("onkeyup",function(a){e.value=a.srcElement.value,e.id=a.srcElement.id,dispatchCommand(b,e)}))},onDOM:function(a,c){b.addEventListener("DOMContentLoaded",function(b){b.preventDefault(),dispatchCommand(a,c)},!1)},onDevice:function(a,c){b.addEventListener("deviceready",function(b){b.preventDefault(),dispatchCommand(a,c)},!1)},onLoad:function(a,b){d.addEventListener("load",function(c){dispatchCommand(a,b)},!1)},onResume:function(a,c){b.addEventListener("resume",function(b){b.preventDefault(),dispatchCommand(a,c)},!1)},onStage:function(a,b){var c=function(c){c.target.className.indexOf("middle")>-1&&(c.preventDefault(),dispatchCommand(a,b))};d.addEventListener("webkitTransitionEnd",c,!1),d.addEventListener("mozTransitionEnd",c,!1),d.addEventListener("msTransitionEnd",c,!1),d.addEventListener("oTransitionEnd",c,!1),d.addEventListener("transitionend",c,!1)},onTap:function(b,c){var e=c||{};"ontouchstart"in a?d.addEventListener("touchstart",function(a){e.type="start",e.startX=a.touches[0].clientX,e.startY=a.touches[0].clientY;var d=a.touches[0].target,f=c.watch.split(":");d[f[0]]!==f[1]&&(d=d.parentNode,d[f[0]]!==f[1]&&(d=d.parentNode)),d[f[0]]===f[1]&&(e.element=d),dispatchCommand(b,e)}):d.addEventListener("mousedown",function(a){e.type="start",e.offsetX=a.offsetX||a.layerX,e.offsetY=a.offsetY||a.layerY,e.startX=a.clientX,e.startY=a.clientY;var d=a.target,f=c.watch.split(":");d[f[0]]!==f[1]&&(d=d.parentNode,d[f[0]]!==f[1]&&(d=d.parentNode)),d[f[0]]===f[1]&&(e.element=d),dispatchCommand(b,e)}),"ontouchmove"in a?d.addEventListener("touchmove",function(a){e.type="move",e.clientX=a.touches[0].clientX,e.clientY=a.touches[0].clientY,dispatchCommand(b,e)}):d.addEventListener("mousemove",function(a){e.type="move",e.clientX=a.clientX,e.clientY=a.clientY,dispatchCommand(b,e)}),"ontouchend"in a?d.addEventListener("touchend",function(a){a.preventDefault(),e.type="end",dispatchCommand(b,e)}):d.addEventListener("mouseup",function(a){a.preventDefault(),e.type="end",dispatchCommand(b,e)})},html:function(a){d.innerHTML=a},text:function(a){return d.innerHTML="",d.appendChild(b.createTextNode(a)),DOM(d)},createChild:function(a){return b.createElement(a)},addOptions:function(a,c,e,f){var g=b.createDocumentFragment();if(!f)for(var h=a;h<=c;h++){var i=b.createElement("option");i.textContent=h<10?"0"+h:h,i.value=h,e==h&&(i.selected="selected"),g.appendChild(i)}return d.appendChild(g),DOM(d)},appendChild:function(a,b,c){var e=typeof a=="string"?this.createChild(a):a;for(var f in b)e.setAttribute(f,b[f]);return c&&(e.innerHTML=c),d.appendChild(e),e},addChild:function(a,b,c){var e=typeof a=="string"?this.createChild(a):a;for(var f in b)e.setAttribute(f,b[f]);return c&&(a=="textarea"?e.value=c:e.innerHTML=c),d.appendChild(e),DOM(e)},attrib:function(a){function b(b,c){d[a]=d[a].replace(b,c)}function c(b){d[a]+=" "+b}function e(b){d[a]=b}function f(b){d[a]=d[a].split(b).join("")}return{replace:b,add:c,remove:f,set:e}},translate:function(a){function b(c){for(var d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];e.tagName=="LI"&&console.log("TODO LISTE");if(e.tagName=="P"){var f=e.innerHTML.trim();a[f]&&(e.innerHTML=a[f])}e.childNodes.length>0&&b(e)}}return b(d),d},width:function(){return parseInt(d.clientWidth)},style:function(a,b){d.style[a]=b},show:function(){return d.style.display="block",DOM(d)},hide:function(){return d.style.display="none",DOM(d)},removeElement:function(){d.parentNode.removeChild(d)},removeElements:function(){while(d.hasChildNodes())d.removeChild(d.lastChild);return DOM(d)},element:function(){return d}};return e};a.DOM=d,a.DO=d()})(this,document,undefined);
function Node(a){this.server=a}Node.prototype.readActorsByCredential=function(a,b,c){this.query("GET","/authenticate?"+a,b,c)},Node.prototype.readActorByRequestToken=function(a,b,c){this.query("GET","/authorize?requestToken="+a,b,c)},Node.prototype.findActorsForRoleId=function(){},Node.prototype.findActorsForScopeId=function(a,b,c,d){var e="/actors/scopeId/"+a;this.query("GET",e,c,d,null,b)},Node.prototype.findActorForId=function(){},Node.prototype.updateActorById=function(a,b,c,d){var e="/actors/"+a;this.query("PUT",e,c,d,b)},Node.prototype.listActsForAntagonistId=function(a,b,c,d){var e="/acts/antagonistId/"+a;e+=b?"?since="+b:"",this.query("GET",e,c,d)},Node.prototype.createAct=function(a,b,c){var d="/acts";this.query("POST",d,b,c,a)},Node.prototype.readAct=function(){},Node.prototype.updateAct=function(){},Node.prototype.deleteAct=function(a,b,c){var d="/acts/"+a.id;this.query("DELETE",d,b,c)},Node.prototype.actLikeEntity=function(a,b,c,d){var e="/acts/"+a+"/like/"+b;this.query("GET",e,c,d)},Node.prototype.actDislikeEntity=function(a,b,c,d){var e="/acts/"+a+"/dislike/"+b;this.query("GET",e,c,d)},Node.prototype.actClickEntity=function(a,b,c,d){var e="/acts/"+a+"/click/"+b;this.query("GET",e,c,d)},Node.prototype.findEntities=function(){},Node.prototype.findEntitiesById=function(){},Node.prototype.findEvaluationForEntity=function(a,b,c,d){var e="/entities/"+a+"/evaluation/"+b;this.query("GET",e,c,d)},Node.prototype.getDevice=function(a,b,c,d,e,f,g){var h="/logo/"+a+"/"+b;if(c||d||e)h+="?";c&&(h+="since="+c),d&&(h+="&protagonistId="+d),e&&(h+="&antagonistId="+e),this.query("GET",h,f,g)},Node.prototype.query=function(a,b,c,d,e,f){var g=new XMLHttpRequest;g.open(a,this.server+b,!0),e&&g.setRequestHeader("Content-Type","application/json"),f&&g.setRequestHeader("Authorization",f),g.onreadystatechange=function(){g.readyState==4&&(g.status==200&&g.responseText?c(JSON.parse(g.responseText)):d({status:g.status,message:g.statusText}))},g.send(JSON.stringify(e))};
function Agent(){this.device="Unknown",this.os="Unknown",this.browser="Unknown",this.version=0,this.can=[],this.parse()}Agent.prototype.parse=function(){/iPhone/i.test(navigator.userAgent)&&(this.device="Mobile"),/iPad/i.test(navigator.userAgent)&&(this.device="Tablet"),/Android/i.test(navigator.userAgent)&&(this.device=/Android.*Mobile/i.test(navigator.userAgent)?"Mobile":"Tablet"),/BlackBerry/i.test(navigator.userAgent)&&(this.device="Mobile",this.os="RIM"),/PlayBook/i.test(navigator.userAgent)&&(this.device="Tablet",this.os="RIM"),/Kindle|Kindle Fire/i.test(navigator.userAgent)&&(this.device="Tablet"),/Opera Mobi/i.test(navigator.userAgent)&&(this.device="Mobile"),/Windows Phone/i.test(navigator.userAgent)&&(this.device="Mobile",this.os="Windows"),/IEMobile/i.test(navigator.userAgent)&&(this.device="Mobile",this.os="Windows"),/MeeGo/i.test(navigator.userAgent)&&(this.device="Mobile"),/(nuhk)|(GoogleBot)|(YammyBot)|(OpenBot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/i.test(navigator.userAgent)&&(this.device="Bot"),/Firefox[\/\s](\d+)(\.\d+)+/.test(navigator.userAgent)&&(this.browser="Firefox",this.version=new Number(RegExp.$1)),/MSIE (\d+)(\.\d+)+;/.test(navigator.userAgent)&&(this.browser="Internet Explorer",this.version=new Number(RegExp.$1)),/Opera[\/\s](\d+)(\.\d+)+/.test(navigator.userAgent)&&(this.browser="Opera",this.version=new Number(RegExp.$1)),/Safari/.test(navigator.userAgent)&&(this.browser="Safari",/Version\/(\d+)(\.\d+)+/.test(navigator.userAgent)&&(this.version=new Number(RegExp.$1))),/Chrome[\/\s](\d+)(\.\d+)+/.test(navigator.userAgent)&&(this.browser="Chrome",this.version=new Number(RegExp.$1)),this.device=="Unknown"&&(/Windows NT (\d\.)/i.test(navigator.userAgent)&&(this.os="Windows",this.device="Desktop"),/(Linux)|(X11)/.test(navigator.userAgent)&&(this.os="Linux",this.device="Desktop"),/(Mac_PowerPC)|(Macintosh)|(Mac OS)/i.test(navigator.userAgent)&&(this.os="Mac OS",this.device="Desktop"));if(navigator.mimeTypes&&navigator.mimeTypes.length){var a=navigator.mimeTypes["application/x-shockwave-flash"];a&&a.enabledPlugin&&this.can.push("Flash")}!document.createElement("video").canPlayType||this.can.push("HTML5")},Agent.prototype.capable=function(a){var b=this.can.length;while(b--)if(this.can[b]===a)return!0;return!1},Agent.prototype.isDevice=function(a){return this.device===a},Agent.prototype.isLandscape=function(){return this.isDevice("Mobile")&&document.documentElement.clientWidth>document.documentElement.clientHeight};
